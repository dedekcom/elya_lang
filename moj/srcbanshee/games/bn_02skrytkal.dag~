
public e1_check_mlotek_dluto	{
	if( clsave.bis("ma_mlotek") && clsave.bis("ma_dluto") )	{
		.removefrompck("mlotek");
		.removefrompck("dluto");
		.addtopck("mlotek_dluto");
	}
}

game mg02SkrytkaL : Banshee	{
	init	{
		Banshee::init("mg02_skrytkal");
//		.addtopck("gzyms1"); 
//    .addtopck("gzyms2"); 
		.imgs = (A, "$scripts/mg02_gniazdo/bkg.jpg", "bgpop.pyz 5", "sciana.pyz 15", "mlotek.pyz 10",
			"podgzyms1.pyz 20", "podgzyms2.pyz 20", "maskabg.pyz 30", "popexit.pyz 40");
		.butpopexit;
		anmaskabg.addtogamevars("anramka");
		.butpopexitisinramka;
		
		.sfxs = (A, "bgrwiatrN", "bgrlas2N 40", "glaz", "ceglaput");
		
		// e1_ad02_skrytka_otwarta, e1_ad02_gzyms1put
		
		if( clsave.bis("taken_mlotek") )	anmlotek.hide;
		else .setasitemtopck("anmlotek");
		
		if( clsave.bis("e1_ad02_gzyms1put") )	{
			anpodgzyms1.hide;
		} else {
			anpodgzyms1.Button_stdms;
      anpodgzyms1.addmethod("butmoveon", func {
				if( !.advstdstate) return;
				  if (!clsave.bis("e1_ad02_gzyms1put"))
            advmouse.set("use");   
        } );
			anpodgzyms1.addmethod("butmoveoff", func {
				if( !.advstdstate ) return;
				  advmouse.setstd;
				} );    
			butgame.add("anpodgzyms1");
		}
		if( clsave.bis("e1_ad02_gzyms2put") )	{
			anpodgzyms2.hide;
		} else {
			anpodgzyms2.Button_stdms;
      anpodgzyms2.addmethod("butmoveon", func {
				if( !.advstdstate) return;
				  if (!clsave.bis("e1_ad02_gzyms2put"))
            advmouse.set("use");   
        } );
			anpodgzyms2.addmethod("butmoveoff", func {
				if( !.advstdstate ) return;
				  advmouse.setstd;
				} );    
			butgame.add("anpodgzyms2");
		}
		
		if( clsave.bis("e1_ad02_skrytka_otwarta") )	{
			ansciana.setframe("opened",0);
		} else {
			anmlotek.hide;
			ansciana.addmethod("isbutin", func { (@x, @y)
				.isin(x,y,1,1) && !anpodgzyms1.isvisible && !anpodgzyms2.isvisible;
				} );
			ansciana.Button_moveonms;
			ansciana.Button_moveoffms;
			ansciana.addmethod("butclick", func {
				if( !.advstdstate ) return;
				butgame.removebut(this);
				butgame.onmousemove;
				clsave.bset("e1_ad02_skrytka_otwarta");
				sgmstate = "state_opensciana";
				anmlotek.show;
				.anplaysmoothfin( "open", func {
					.advsetstdstate;
					} );
				} );
			butgame.add("ansciana");
		}
		if (!clsave.bis("e1_ad02_gzyms1put") && !clsave.bis("e1_ad02_gzyms2put"))
    { 
      .newsnd("snd_intro", "kinnat_c1d1_3");
      snd_intro.addmethod("onfinish", "advsetstdstate");     
      .cbplay("snd_intro"); 
       
    } 
    
    
		.stdstart;
	}
	anmlotek_TAKE	{
		//.saveitemtopck("mlotek");
		.popitem_gotocenter("mlotek");
	}
	anmlotek_INPCK	{
		.addtopck("mlotek");
		.timfinito;
	//	.e1_check_mlotek_dluto;
	}
	USE_gzyms1	{
		.advsetstdstate;
		if( anpodgzyms1.isin(mouse.getpos,1,0) )	{
			fxceglaput.play;
			clsave.bset("e1_ad02_gzyms1put");
			anpodgzyms1.hide;
			.removefrompck("gzyms1");
			advmouse.setstd;
		} else .item_gotopck;
	}
	USE_gzyms2	{
		.advsetstdstate;
		if( anpodgzyms2.isin(mouse.getpos,1,0) )	{
			fxceglaput.play;
			clsave.bset("e1_ad02_gzyms2put");
			anpodgzyms2.hide;
			.removefrompck("gzyms2");
			advmouse.setstd;
		} else .item_gotopck;
	}
   HINT_CLICK {
    	if (clsave.bis("ma_gzyms1") && !clsave.bis("e1_ad02_gzyms1put"))	{
    		.showhint("anpodgzyms1");
        .showhintitem("gzyms1");
      }
      else if (clsave.bis("ma_gzyms2")&& !clsave.bis("e1_ad02_gzyms2put"))	{
    		.showhint("anpodgzyms2");
        .showhintitem("gzyms2");  
    	}
      
      else if (clsave.bis("e1_ad02_gzyms1put") & clsave.bis("e1_ad02_gzyms2put") & !clsave.bis("e1_ad02_skrytka_otwarta")) 
        .showhint("anmaskabg");
      else if (clsave.bis("e1_ad02_skrytka_otwarta") && !clsave.bis("taken_mlotek")) 
        .showhint("anmlotek");
      else {
    		.showhint("anpopexit");
    	}
  } 
  
  
  
	mend	{
		.stdexitdefadv("ad02_brama", "gamead02_brama0");
	}
}




game mg08_doniczki :Banshee {
	init{
    Banshee::init("mg08_doniczki");
    
    mus.playstr("adventure_loop -v 30 -l");
    .sfxs = (A, "wlewa1", "swist1");
    .imgs = (A,"bkg.jpg 1","popup_bkg.pyz 2", "doniczka1.pyz 3", "doniczka2.pyz 4", "doniczka3.pyz 5", "ziarenko1.pyzH 5", "ziarenko2.pyzH 6", "ziarenko3.pyzH 7", "elixir1.pyzH 8", "roslinka1.pyzH 9", "elixir2.pyzH 10", "roslinka2.pyzH 11", "elixir3.pyzH 12", "roslinka3.pyzH 13", "ramka.pyz 14", "konewka1.pyzH 15","konewka2.pyzH 16","konewka3.pyzH 16", "popexit.pyz 25");
      
   /*   if (!clsave.bis("e1_ad08_doniczki_items_added"))
      {
        .addtopck("ziarno"); 
        .addtopck("elixir");
        .addtopck("konewka");  
        clsave.bset("e1_ad08_doniczki_items_added");
      }    */
    anpopup_bkg {
  		.Button_isinalpha;
  		butgame.add(this);
  	};
    
    anelixir1.addmethod("onfinish",func{ .hide; .advsetstdstate;}); 
    anelixir2.addmethod("onfinish",func{ .hide; .advsetstdstate;}); 
    anelixir3.addmethod("onfinish",func{ .hide; .advsetstdstate;}); 
    
    ankonewka1.addmethod("onfinish",func{ .hide; .advsetstdstate;}); 
    ankonewka2.addmethod("onfinish",func{ .hide; .advsetstdstate;}); 
    ankonewka3.addmethod("onfinish",func{ .hide; .advsetstdstate;}); 
  
     imgbkg {
  		.Button_isinalpha;
  		.addmethod("butclick", func {
  			if( !.advstdstate || sgmstate == "getitem" || sgmstate == "anim" ) return;
  			 .mend;
  			} );
    		butgame.add(this);
    	};       
      .butpopexit;     
     .stdstart; 
     
     if (clsave.bis("e1_ad08_doniczka1_ziarno_in"))
     {
        anziarenko1.show();
     }
     
     if (clsave.bis("e1_ad08_doniczka2_ziarno_in"))
     {
        anziarenko2.show();
     }
     
     if (clsave.bis("e1_ad08_doniczka3_ziarno_in"))
     {
        anziarenko3.show();
     }
     
      if (clsave.bis("e1_ad08_doniczka1_elixir_in"))
     {
        anziarenko1.hide;
     }
     
     if (clsave.bis("e1_ad08_doniczka2_elixir_in"))
     {
        anziarenko2.hide();
     }
     
     if (clsave.bis("e1_ad08_doniczka3_elixir_in"))
     {
        anziarenko3.hide();
     }
     
     if (!clsave.bis("e1_ad08_doniczka1_elixir_in"))
        andoniczka1{
        .Button_isinvis;
        .addmethod("butmoveon", func {
  				if( !.advstdstate) return;
  				  if (!clsave.bis("e1_ad08_doniczka1_elixir_in"))
              advmouse.set("use"); 
            else
               advmouse.setstd;  
        } );
  			.addmethod("butmoveoff", func {
  				if( !.advstdstate ) return;
  				  advmouse.setstd;
  				} ); 
          butgame.add(this);
      }; 
      
      if (!clsave.bis("e1_ad08_doniczka2_elixir_in"))
        andoniczka2{
        .Button_isinvis;
        .addmethod("butmoveon", func {
  				if( !.advstdstate) return;
  				  if (!clsave.bis("e1_ad08_doniczka2_elixir_in"))
              advmouse.set("use"); 
            else
               advmouse.setstd;  
        } );
  			.addmethod("butmoveoff", func {
  				if( !.advstdstate ) return;
  				  advmouse.setstd;
  				} ); 
          butgame.add(this);
      };
      if (!clsave.bis("e1_ad08_doniczka3_elixir_in"))
        andoniczka3{
        .Button_isinvis;
        .addmethod("butmoveon", func {
  				if( !.advstdstate) return;
  				  if (!clsave.bis("e1_ad08_doniczka3_elixir_in"))
              advmouse.set("use"); 
            else
               advmouse.setstd;  
        } );
  			.addmethod("butmoveoff", func {
  				if( !.advstdstate ) return;
  				  advmouse.setstd;
  				} ); 
          butgame.add(this);
      };                
      
     
  } // koniec init 
   
   
  
  ziarno_completed()
  {
   clsave.bislist("e1_ad08_doniczka1_ziarno_in & e1_ad08_doniczka2_ziarno_in & e1_ad08_doniczka3_ziarno_in");
  }
  
  elixir_completed()
  {
   clsave.bis("e1_ad08_doniczka1_elixir_in") && clsave.bis("e1_ad08_doniczka2_elixir_in") && clsave.bis("e1_ad08_doniczka3_elixir_in");
  }
  konewka_completed()
  {
   clsave.bis("e1_ad08_doniczka1_water_in") && clsave.bis("e1_ad08_doniczka2_water_in") && clsave.bis("e1_ad08_doniczka3_water_in");
  }
  
  
   USE_ziarno {
        .advsetstdstate; 
        if( andoniczka1.isin(mouse.getpos,1,0) && !clsave.bis("e1_ad08_doniczka1_ziarno_in") )	{
          clsave.bset("e1_ad08_doniczka1_ziarno_in");
          anziarenko1.play(1);
          .advsetstate("getitem");
          guimov.setmoved("anitem_ziarno");
          fxswist1.play;
          if(.ziarno_completed)
          { 
            .removefrompck("ziarno");
             guimov.free;
            .advsetstdstate; 
          }
          else
              anitem_ziarno.anfadeout(200,func{anitem_ziarno.anfadein(800,func{.advsetstdstate;} );}); 
              
        } else if( andoniczka2.isin(mouse.getpos,1,0) && !clsave.bis("e1_ad08_doniczka2_ziarno_in") )	{
    			clsave.bset("e1_ad08_doniczka2_ziarno_in");
    		    anziarenko2.play(1);
            .advsetstate("getitem");
            guimov.setmoved("anitem_ziarno");
            fxswist1.play;
          if(.ziarno_completed)
          { 
            .removefrompck("ziarno");
             guimov.free;
            .advsetstdstate; 
          }
          else
              anitem_ziarno.anfadeout(200,func{anitem_ziarno.anfadein(800,func{.advsetstdstate;} );}); 
              
        } else if( andoniczka3.isin(mouse.getpos,1,0) && !clsave.bis("e1_ad08_doniczka3_ziarno_in") )	{
    			 clsave.bset("e1_ad08_doniczka3_ziarno_in");
           anziarenko3.play(1);
           .advsetstate("getitem");
           guimov.setmoved("anitem_ziarno");
           fxswist1.play;
           if(.ziarno_completed)
           { 
            .removefrompck("ziarno");
             guimov.free;
            .advsetstdstate; 
            }
            else
              anitem_ziarno.anfadeout(200,func{anitem_ziarno.anfadein(800,func{.advsetstdstate;} );}); 
            
        }  else .item_gotopck; 
         
    } 
    
    konewka_on_doniczka(int id)	{
	if( <"andoniczka"+id>.isin(mouse.getpos,1,0) && clsave.bis("e1_ad08_doniczka"+id+"_ziarno_in") && !clsave.bis("e1_ad08_doniczka"+id+"_water_in"))	{
          clsave.bset("e1_ad08_doniczka"+id+"_water_in");
          <"ankonewka"+id>.play(1);
          .advsetstate("getitem");
          guimov.setmoved("anitem_konewka");
          fxwlewa1.play;
          if(.konewka_completed)
          { 
            .removefrompck("konewka");
             guimov.free;
            .advsetstdstate;
          }
          else
              anitem_konewka.anfadeout(200,func{anitem_konewka.anfadein(800,"advsetstdstate" );});
          true;
        } else false;
    }
    
    USE_konewka {
        .advsetstdstate; 
        if( .konewka_on_doniczka(1) )	{
        } else if( .konewka_on_doniczka(2) )	{
        } else if( .konewka_on_doniczka(3) )	{
        } else .item_gotopck; 
         
    } 
    
    go_to_next_location{
      .watch_film("cs08_doniczki", "-def", "ad12_latajacecosna");    
    }
    
    elixir_on_doniczka(int id)	{
	if( <"andoniczka"+id>.isin(mouse.getpos,1,0) && clsave.bis("e1_ad08_doniczka"+id+"_ziarno_in") && !clsave.bis("e1_ad08_doniczka"+id+"_elixir_in") )	{
		clsave.bset("e1_ad08_doniczka"+id+"_elixir_in");
		<"anelixir"+id>.play(1);
		<"anroslinka"+id>.play(1);
		.advsetstate("getitem");
		guimov.setmoved("anitem_elixir");
		butgame.removebut("andoniczka"+id);
		if(.elixir_completed)	{ 
			.removefrompck("elixir");
			guimov.free;
			.advsetstdstate;
			.set_mg_finished(); 
			.go_to_next_location(); 
		} else
			anitem_elixir.anfadeout(200,func{anitem_elixir.anfadein(800,func{.advsetstdstate; advmouse.setstd; } );});
		true;
	} else false;
    }
    USE_elixir {
        .advsetstdstate; 
        if( .elixir_on_doniczka(1) ) {}
        else if( .elixir_on_doniczka(2) ) {}
        else if( .elixir_on_doniczka(3) ) {}
	else .item_gotopck; 
    }
  
  
  mend	{
    if (.is_mg_finished)
      .stdexitdefadv("ad12_latajacecosna", "gamead12_latajacecosna0");
    else
      .stdexitdefadv("ad08_latajacecospod", "gamead08_latajacecospod0");
  }
  
  HINT_CLICK {
	if( clsave.bis("ma_ziarno") )	{
		if (!clsave.bis("e1_ad08_doniczka1_ziarno_in") ) {
			.showhintitem("ziarno");
			.showhint("andoniczka1");
		} else if (!clsave.bis("e1_ad08_doniczka2_ziarno_in") ) {
			.showhintitem("ziarno");
			.showhint("andoniczka2");
		} else if (!clsave.bis("e1_ad08_doniczka3_ziarno_in") ) {
			.showhintitem("ziarno");
			.showhint("andoniczka3");
		}
	} else if ( clsave.bis("ma_elixir") )	{
		if (!clsave.bis("e1_ad08_doniczka3_elixir_in") )	{
			.showhintitem("elixir");
			.showhint("andoniczka3");
		} else if (!clsave.bis("e1_ad08_doniczka2_elixir_in") )	{
			.showhintitem("elixir");
			.showhint("andoniczka2");
		} else if (!clsave.bis("e1_ad08_doniczka1_elixir_in") )	{
			.showhintitem("elixir");
			.showhint("andoniczka1");
		}  
	} else
		.showhint("anpopexit"); 
  }       
}
 

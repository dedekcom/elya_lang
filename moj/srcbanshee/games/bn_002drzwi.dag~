
game mg002_drzwi : Banshee	{
	init	{
		Banshee::init("mg002_drzwi");
		.imgs = (A, "bkg.jpg 1", "pop_bkg.pyz 2","klamka_obszar.pyzH 3",  "ramka.pyz 4" ,"klamka.pyzH 5", "popexit.pyz 6");  
   	.butpopexit;
    .sfxs = (A, "bgrszumN 30","bgrogienN 15", "opendoor 60", "szufladaklik");
    .newsndfree("sndnidaklamka", "kinnat_c0d0_3a");
    imgbkg {
  		.addmethod("isbutin", func { (@x, @y)
  			!anpop_bkg.isin(x,y,0,0);
  			} );
  		.addmethod("butclick", func {
  			if( !.advstdstate ) return;
  			 .mend;
  			} );
    		butgame.add(this);
  	};       
    
     
    if (!clsave.bis("e1_ad002_kswew_klamka_wlozona"))
    { 
      anklamka_obszar{
        .Button_isinvis;
        .addmethod("butmoveon", func {
  				if( !.advstdstate) return;
  				  advmouse.set("use");
  				  if( clsave.bgo("e1_t4gears_shown") )
					.show_tutorial("T4gears", .rtutpos);
          } );
  			.addmethod("butmoveoff", func {
  				if( !.advstdstate ) return;
  				  advmouse.setstd;
  				} ); 
          butgame.add(this);
        };   
     }
    
    anklamka{
			.addmethod("isbutin", func { (int x, int y)
			  .advstdstate && .isin(x,y,0,0) && anklamka.isvisible;
				} ); 
			.Button_moveonms;
			.Button_moveoffms;
			.addmethod("butclick", func {
			if( !.advstdstate  ) return;
				fxopendoor.play;
			   anklamka.play("push"); 
      } );
      butgame.add(this);
		};
    
    anklamka {
      .addmethod("onfinish", func {
			   .set_mg_finished; 
          clsave.bset("e1_ad002_drzwi_otwarte") ;
          .mend;   
          
      } );
    };
    
    if (clsave.bis("e1_ad002_kswew_klamka_wlozona"))
    { 
      anklamka.show;
      
    }
    
    
		.stdstart;
  } //koniec init
  
  USE_klamka	{
		.advsetstdstate();
    if( anklamka_obszar.isin(mouse.getpos,0,0) )	{
      .removefrompck("klamka");
      anklamka.show();
      fxszufladaklik.play;
      butgame.removebut("anklamka_obszar"); 
      clsave.bset("e1_ad002_kswew_klamka_wlozona");  
    } else {
		  .advsetstdstate; 
      .item_gotopck;
		}
	} 
  
  mend	{
    .stdexitdefadv("ad002_kswew", "gamead002_kswew0");
	} 
  
  HINT_CLICK {
    if (!clsave.bis("e1_ad002_kswew_klamka_wlozona") && clsave.bis("taken_klamka") ) 
    {  
      .showhintitem("klamka");
      .showhint("anklamka_obszar");
      .unblock_inventory(2000);
    }
    else if(clsave.bis("e1_ad002_kswew_klamka_wlozona"))
      .showhint("anklamka");  
    else
      .showhint("anpopexit"); 
  }               
}